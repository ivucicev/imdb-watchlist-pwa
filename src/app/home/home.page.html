<ion-header [scrollHide]="headerScrollConfig" [scrollContent]="pageContent">
    <ion-toolbar>
        <ion-searchbar (ionChange)="searching($event)"></ion-searchbar>
    </ion-toolbar>
</ion-header>
<ion-content [scrollEvents]="true" #pageContent>
    <ion-refresher slot="fixed" (ionRefresh)="reloadData($event)">
        <ion-refresher-content pullingText="Pull to refresh...">
        </ion-refresher-content>
    </ion-refresher>
    <ion-card *ngIf="isInitial" class="card-content">
        <img src="assets/imdb.png" />
        <ion-card-content>
            Please enter your IMDB username, also make sure that you watchlist is set to public!
        </ion-card-content>
        <ion-list>
            <ion-item>
                <ion-input placeholder="IMDB username" [(ngModel)]="username"></ion-input>
                <ion-button slot="end" color="primary" fill="outline"
                    [attr.disabled]="!username || username.length !=  10" (click)="saveUsername()">
                    OK
                </ion-button>
            </ion-item>
            <br>
        </ion-list>
    </ion-card>
    <ion-card *ngFor="let movie of movies" class="card-content">
        <img [src]="movie?.title?.poster?.url" />
        <ion-card-header>
            <ion-card-title>{{movie?.title?.primary?.title }}</ion-card-title>
            <ion-card-subtitle>{{  movie?.starbar?.aggregate }} {{ movie?.title?.metadata?.genres.join(', ') }}
            </ion-card-subtitle>
            <ion-card-subtitle>
                <span *ngFor="let star of movie?.title?.credits?.star; let i = index">
                    {{ star.name }}<span *ngIf="i <  movie?.title?.credits?.star.length - 1">, </span>
                </span>
            </ion-card-subtitle>
        </ion-card-header>
        <ion-card-content>
            {{ movie?.title?.plot }}
        </ion-card-content>
        <ion-card-content>
            Ways to watch
            <br>
            <a class="offer-container amazon" *ngIf="movie?.offers?.amazonprime" [href]="movie?.offers?.amazonprime"
                target="_blank">
                <div class="offer-icon">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <title>Amazon icon</title>
                        <path
                            d="M.045 18.02c.072-.116.187-.124.348-.022 3.636 2.11 7.594 3.166 11.87 3.166 2.852 0 5.668-.533 8.447-1.595l.315-.14c.138-.06.234-.1.293-.13.226-.088.39-.046.525.13.12.174.09.336-.12.48-.256.19-.6.41-1.006.654-1.244.743-2.64 1.316-4.185 1.726-1.53.406-3.045.61-4.516.61-2.265 0-4.41-.396-6.435-1.187-2.02-.794-3.82-1.91-5.43-3.35-.1-.074-.15-.15-.15-.22 0-.047.02-.09.05-.13zm6.565-6.218c0-1.005.247-1.863.743-2.577.495-.71 1.17-1.25 2.04-1.615.796-.335 1.756-.575 2.912-.72.39-.046 1.033-.103 1.92-.174v-.37c0-.93-.105-1.558-.3-1.875-.302-.43-.78-.65-1.44-.65h-.182c-.48.046-.896.196-1.246.46-.35.27-.575.63-.675 1.096-.06.3-.206.465-.435.51l-2.52-.315c-.248-.06-.372-.18-.372-.39 0-.046.007-.09.022-.15.247-1.29.855-2.25 1.82-2.88.976-.616 2.1-.975 3.39-1.05h.54c1.65 0 2.957.434 3.888 1.29.135.15.27.3.405.48.12.165.224.314.283.45.075.134.15.33.195.57.06.254.105.42.135.51.03.104.062.3.076.615.01.313.02.493.02.553v5.28c0 .376.06.72.165 1.036.105.313.21.54.315.674l.51.674c.09.136.136.256.136.36 0 .12-.06.226-.18.314-1.2 1.05-1.86 1.62-1.963 1.71-.165.135-.375.15-.63.045-.195-.166-.375-.332-.526-.496l-.31-.347c-.06-.074-.166-.21-.317-.42l-.3-.435c-.81.886-1.603 1.44-2.4 1.665-.494.15-1.093.227-1.83.227-1.11 0-2.04-.343-2.76-1.034-.72-.69-1.08-1.665-1.08-2.94l-.05-.076zm3.753-.438c0 .566.14 1.02.425 1.364.285.34.675.512 1.155.512.045 0 .106-.007.195-.02.09-.016.134-.023.166-.023.614-.16 1.08-.553 1.424-1.178.165-.28.285-.58.36-.91.09-.32.12-.59.135-.8.015-.195.015-.54.015-1.005v-.54c-.84 0-1.484.06-1.92.18-1.275.36-1.92 1.17-1.92 2.43l-.035-.02zm9.162 7.027c.03-.06.075-.11.132-.17.362-.243.714-.41 1.05-.5.55-.133 1.09-.222 1.612-.24.14-.012.28 0 .41.03.65.06 1.05.168 1.172.33.063.09.09.228.09.39v.15c0 .51-.14 1.11-.415 1.8-.278.69-.664 1.248-1.156 1.68-.073.06-.14.09-.197.09-.03 0-.06 0-.09-.012-.09-.044-.107-.12-.064-.24.54-1.26.806-2.143.806-2.64 0-.15-.03-.27-.087-.344-.145-.166-.55-.257-1.224-.257-.243 0-.533.016-.87.046-.363.045-.7.09-1 .135-.09 0-.148-.014-.18-.044-.03-.03-.036-.047-.02-.077 0-.017.006-.03.02-.063v-.06z" />
                    </svg>
                </div>
                Prime
            </a>
            <a class="offer-container amazon" *ngIf="movie?.offers?.amazon" [href]="movie?.offers?.amazon"
                target="_blank">
                <div class="offer-icon">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <title>Amazon icon</title>
                        <path
                            d="M.045 18.02c.072-.116.187-.124.348-.022 3.636 2.11 7.594 3.166 11.87 3.166 2.852 0 5.668-.533 8.447-1.595l.315-.14c.138-.06.234-.1.293-.13.226-.088.39-.046.525.13.12.174.09.336-.12.48-.256.19-.6.41-1.006.654-1.244.743-2.64 1.316-4.185 1.726-1.53.406-3.045.61-4.516.61-2.265 0-4.41-.396-6.435-1.187-2.02-.794-3.82-1.91-5.43-3.35-.1-.074-.15-.15-.15-.22 0-.047.02-.09.05-.13zm6.565-6.218c0-1.005.247-1.863.743-2.577.495-.71 1.17-1.25 2.04-1.615.796-.335 1.756-.575 2.912-.72.39-.046 1.033-.103 1.92-.174v-.37c0-.93-.105-1.558-.3-1.875-.302-.43-.78-.65-1.44-.65h-.182c-.48.046-.896.196-1.246.46-.35.27-.575.63-.675 1.096-.06.3-.206.465-.435.51l-2.52-.315c-.248-.06-.372-.18-.372-.39 0-.046.007-.09.022-.15.247-1.29.855-2.25 1.82-2.88.976-.616 2.1-.975 3.39-1.05h.54c1.65 0 2.957.434 3.888 1.29.135.15.27.3.405.48.12.165.224.314.283.45.075.134.15.33.195.57.06.254.105.42.135.51.03.104.062.3.076.615.01.313.02.493.02.553v5.28c0 .376.06.72.165 1.036.105.313.21.54.315.674l.51.674c.09.136.136.256.136.36 0 .12-.06.226-.18.314-1.2 1.05-1.86 1.62-1.963 1.71-.165.135-.375.15-.63.045-.195-.166-.375-.332-.526-.496l-.31-.347c-.06-.074-.166-.21-.317-.42l-.3-.435c-.81.886-1.603 1.44-2.4 1.665-.494.15-1.093.227-1.83.227-1.11 0-2.04-.343-2.76-1.034-.72-.69-1.08-1.665-1.08-2.94l-.05-.076zm3.753-.438c0 .566.14 1.02.425 1.364.285.34.675.512 1.155.512.045 0 .106-.007.195-.02.09-.016.134-.023.166-.023.614-.16 1.08-.553 1.424-1.178.165-.28.285-.58.36-.91.09-.32.12-.59.135-.8.015-.195.015-.54.015-1.005v-.54c-.84 0-1.484.06-1.92.18-1.275.36-1.92 1.17-1.92 2.43l-.035-.02zm9.162 7.027c.03-.06.075-.11.132-.17.362-.243.714-.41 1.05-.5.55-.133 1.09-.222 1.612-.24.14-.012.28 0 .41.03.65.06 1.05.168 1.172.33.063.09.09.228.09.39v.15c0 .51-.14 1.11-.415 1.8-.278.69-.664 1.248-1.156 1.68-.073.06-.14.09-.197.09-.03 0-.06 0-.09-.012-.09-.044-.107-.12-.064-.24.54-1.26.806-2.143.806-2.64 0-.15-.03-.27-.087-.344-.145-.166-.55-.257-1.224-.257-.243 0-.533.016-.87.046-.363.045-.7.09-1 .135-.09 0-.148-.014-.18-.044-.03-.03-.036-.047-.02-.077 0-.017.006-.03.02-.063v-.06z" />
                    </svg>
                </div>
                Amazon
            </a>
            <a class="offer-container hbogo" *ngIf="movie?.offers?.hbonow" [href]="movie?.offers?.hbonow"
                target="_blank">
                <div class="offer-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="50px"
                        height="50px" viewBox="0 0 50 50" version="1.1" fill="#000000">
                        <g id="surface310179">
                            <path style=" stroke:none;fill-rule:nonzero;fill:#000000;fill-opacity:1;"
                                d="M 1 5 L 1 25 L 6 25 L 6 17 L 9 17 L 9 25 L 14 25 L 14 5 L 9 5 L 9 13 L 6 13 L 6 5 Z M 16 5 L 16 25 L 25 25 C 27.800781 25 30 22.800781 30 20 C 30 19.726562 29.976562 19.449219 29.9375 19.1875 C 31.53125 22.605469 34.996094 25 39 25 C 44.5 25 49 20.5 49 15 C 49 9.5 44.5 5 39 5 C 34.996094 5 31.53125 7.394531 29.9375 10.8125 C 29.976562 10.550781 30 10.273438 30 10 C 30 7.199219 27.800781 5 25 5 Z M 21 9 L 23.5 9 C 24.300781 9 25 9.699219 25 10.5 C 25 11.300781 24.300781 12 23.5 12 L 21 12 Z M 39 9 C 42.300781 9 45 11.699219 45 15 C 45 18.300781 42.300781 21 39 21 C 35.699219 21 33 18.300781 33 15 C 33 11.699219 35.699219 9 39 9 Z M 39 11 C 36.800781 11 35 12.800781 35 15 C 35 17.199219 36.800781 19 39 19 C 41.199219 19 43 17.199219 43 15 C 43 12.800781 41.199219 11 39 11 Z M 29.34375 12.5 C 29.132812 13.300781 29 14.132812 29 15 C 29 15.867188 29.132812 16.699219 29.34375 17.5 C 28.488281 15.996094 26.882812 15 25 15 C 26.882812 15 28.488281 14.003906 29.34375 12.5 Z M 21 18 L 23.5 18 C 24.300781 18 25 18.699219 25 19.5 C 25 20.300781 24.300781 21 23.5 21 L 21 21 Z M 15.09375 27 C 9.492188 27 5 31.5 5 37 C 5 42.5 9.5 47 15 47 C 20.5 47 25 42.5 25 37 C 25 36.699219 25.007812 36.300781 24.90625 36 L 14 36 L 14 40 L 19 40 C 18.101562 41.199219 16.699219 42 15 42 C 12.199219 42 10 39.800781 10 37 C 10 34.199219 12.199219 32 15 32 C 16.601562 32 18.101562 32.800781 19 34 L 24.59375 34 C 23.292969 29.898438 19.492188 27 15.09375 27 Z M 25 37 C 25 42.5 29.5 47 35 47 C 40.5 47 45 42.5 45 37 C 45 31.5 40.5 27 35 27 C 29.5 27 25 31.5 25 37 Z M 35 31 C 38.300781 31 41 33.699219 41 37 C 41 40.300781 38.300781 43 35 43 C 31.699219 43 29 40.300781 29 37 C 29 33.699219 31.699219 31 35 31 Z M 35 33 C 32.800781 33 31 34.800781 31 37 C 31 39.199219 32.800781 41 35 41 C 37.199219 41 39 39.199219 39 37 C 39 34.800781 37.199219 33 35 33 Z M 35 33 " />
                        </g>
                    </svg>
                </div>
                HBO GO
            </a>
            <a class="offer-container kodi" [href]="'https://kodi.tv'" target="_blank">
                <div class="offer-icon">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <title>Kodi icon</title>
                        <path
                            d="M12.03.047c-.226 0-.452.107-.669.324-.922.922-1.842 1.845-2.763 2.768-.233.233-.455.48-.703.695-.31.267-.405.583-.399.988.02 1.399.008 2.799.008 4.198 0 1.453-.002 2.907 0 4.36 0 .11.002.223.03.327.087.337.303.393.546.15 1.31-1.31 2.618-2.622 3.928-3.933l4.449-4.453c.43-.431.43-.905 0-1.336L12.697.37c-.216-.217-.442-.324-.668-.324zm7.224 7.23c-.223 0-.445.104-.65.309L14.82 11.37c-.428.429-.427.895 0 1.322l3.76 3.766c.44.44.908.44 1.346.002 1.215-1.216 2.427-2.433 3.644-3.647.182-.18.353-.364.43-.615v-.33c-.077-.251-.246-.436-.428-.617-1.224-1.22-2.443-2.445-3.666-3.668-.205-.205-.429-.307-.652-.307zM4.18 7.611c-.086.014-.145.094-.207.157L.209 11.572c-.28.284-.278.677.004.96l2.043 2.046c.59.59 1.177 1.182 1.767 1.772.169.168.33.139.416-.084.044-.114.062-.242.063-.364.004-1.283.004-2.567.004-3.851h-.002V8.184c0-.085-.01-.169-.022-.252-.019-.135-.072-.258-.207-.309a.186.186 0 0 0-.095-.012zm7.908 6.838c-.224 0-.447.106-.656.315L7.66 18.537c-.433.434-.433.899.002 1.334 1.215 1.216 2.43 2.43 3.643 3.649.18.18.361.354.611.433h.33c.244-.069.423-.226.598-.402 1.222-1.23 2.45-2.453 3.676-3.68.43-.43.427-.905-.004-1.338l-3.772-3.773c-.208-.208-.432-.311-.656-.31z" />
                    </svg>
                </div>
                Kodi
            </a>
            <a class="offer-container netflix" *ngIf="movie?.offers?.netflix" [href]="movie?.offers?.netflix"
                target="_blank">
                <div class="offer-icon">
                    <svg class="offer-icon netflix" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <title>Netflix icon</title>
                        <path
                            d="M5.39.004l4.75 13.46v-.007l.376 1.06c2.088 5.908 3.21 9.075 3.216 9.082.004 0 .32.02.702.04 1.156.05 2.59.18 3.676.31.25.03.466.04.48.03l-4.71-13.36-.436-1.23-2.423-6.85c-.46-1.3-.85-2.408-.87-2.45L10.12 0H5.395zM13.898.012l-.01 5.306-.008 5.306-.437-1.232V9.39l-.565 11.81c.555 1.567.852 2.403.855 2.407.004.004.32.024.702.042 1.157.05 2.59.18 3.68.31.25.03.467.04.48.03s.02-5.42.017-12.01L18.604.01h-4.706zM5.39.002v11.99c0 6.594.007 11.995.015 12.003s.416-.03.907-.086c.49-.06 1.17-.13 1.51-.16.518-.05 2.068-.15 2.248-.15.052 0 .056-.27.063-5.08l.008-5.08.38 1.06.13.376.57-11.8-.19-.546-.88-2.44-.03-.087H5.39z" />
                    </svg>
                </div>
                Netflix
            </a>
            <a class="offer-container hulu" *ngIf="movie?.offers?.hulu" [href]="movie?.offers?.hulu" target="_blank">
                <div class="offer-icon">
                    <svg class="offer-icon hulu" role="img" width="64" height="64" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <title>Hulu icon</title>
                        <path
                            d="M14.4 7.355h-3.607a5.91 5.91 0 0 0-2.063.405V-.03H2.94v24.06h5.8v-9.51a1.61 1.61 0 0 1 1.56-1.7h3.39a1.59 1.59 0 0 1 1.59 1.56v9.59h5.78V13.54c0-4.41-2.25-6.162-5.9-6.162" />
                    </svg>
                </div>
                Hulu
            </a>
        </ion-card-content>
    </ion-card>
    <ion-infinite-scroll (ionInfinite)="infinite($event)">
        <ion-infinite-scroll-content>
        </ion-infinite-scroll-content>
    </ion-infinite-scroll>
    <ion-infinite-scroll (ionInfinite)="infinite($event)">
        <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data…">
        </ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>